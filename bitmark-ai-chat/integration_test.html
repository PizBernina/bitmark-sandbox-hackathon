<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitmark AI Chat - Tool Animation Integration Test</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/theme-ui@0.16.1/dist/index.umd.js"></script>
    <script src="https://unpkg.com/@emotion/react@11.11.1/dist/emotion-react.umd.min.js"></script>
    <script src="https://unpkg.com/@emotion/styled@11.11.0/dist/emotion-styled.umd.min.js"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useCallback } = React;
        const { Box, Text, Button } = ThemeUI;

        // Mock the types and components for testing
        const ToolUsageIndicator = ({ tool, index = 0 }) => {
            const [isCompleted, setIsCompleted] = React.useState(false);
            const [isVisible, setIsVisible] = React.useState(false);

            React.useEffect(() => {
                const timer = setTimeout(() => {
                    setIsVisible(true);
                }, index * 300);
                return () => clearTimeout(timer);
            }, [index]);

            React.useEffect(() => {
                if (tool.status === 'completed') {
                    const timer = setTimeout(() => setIsCompleted(true), 1000);
                    return () => clearTimeout(timer);
                }
            }, [tool.status]);

            if (!isVisible) return null;

            return React.createElement('div', {
                style: {
                    display: 'inline-flex',
                    alignItems: 'center',
                    gap: '8px',
                    padding: '8px 12px',
                    margin: '4px',
                    borderRadius: '20px',
                    background: isCompleted 
                        ? 'linear-gradient(45deg, #e8f5e8, #d4edda)'
                        : 'linear-gradient(45deg, #f0f0f0, #e0e0e0)',
                    border: `1px solid ${isCompleted ? '#c3e6cb' : '#ddd'}`,
                    fontSize: '14px',
                    animation: isCompleted ? 'toolComplete 0.5s ease-out' : 'toolPulse 1.5s ease-in-out infinite',
                    opacity: isVisible ? 1 : 0,
                    transform: isVisible ? 'translateY(0)' : 'translateY(10px)',
                    transition: 'all 0.3s ease-out',
                }
            }, [
                React.createElement('span', {
                    key: 'emoji',
                    style: {
                        fontSize: '16px',
                        animation: isCompleted ? 'none' : 'toolBounce 1s ease-in-out infinite',
                    }
                }, tool.emoji),
                React.createElement('span', {
                    key: 'description',
                    style: {
                        fontWeight: 500,
                        color: '#333',
                    }
                }, tool.description)
            ]);
        };

        const ToolUsageContainer = ({ tools, isVisible = true }) => {
            if (!tools || tools.length === 0 || !isVisible) return null;

            return React.createElement('div', {
                style: {
                    margin: '10px 0',
                    padding: '10px',
                    background: '#f8f9fa',
                    borderRadius: '8px',
                    borderLeft: '4px solid #007bff',
                    opacity: isVisible ? 1 : 0,
                    transform: isVisible ? 'translateY(0)' : 'translateY(-10px)',
                    transition: 'all 0.3s ease-out',
                }
            }, [
                React.createElement('div', {
                    key: 'header',
                    style: {
                        marginBottom: '8px',
                        fontSize: '12px',
                        color: '#666',
                        fontWeight: 500,
                    }
                }, 'ðŸ¤– AI is using tools...'),
                React.createElement('div', {
                    key: 'tools',
                    style: {
                        display: 'flex',
                        flexWrap: 'wrap',
                        gap: '4px',
                    }
                }, tools.map((tool, index) => 
                    React.createElement(ToolUsageIndicator, {
                        key: `${tool.function_name}-${index}`,
                        tool: tool,
                        index: index
                    })
                ))
            ]);
        };

        const ChatMessage = ({ message }) => {
            return React.createElement('div', {
                style: {
                    display: 'flex',
                    justifyContent: message.sender === 'user' ? 'flex-end' : 'flex-start',
                    marginBottom: '8px',
                }
            }, React.createElement('div', {}, [
                // Tool usage indicators
                message.sender === 'ai' && message.toolUsageIndicators && message.toolUsageIndicators.length > 0 && 
                React.createElement(ToolUsageContainer, {
                    key: 'tool-usage',
                    tools: message.toolUsageIndicators
                }),
                
                // Message content
                React.createElement('div', {
                    key: 'message',
                    style: {
                        maxWidth: '70%',
                        padding: '8px 12px',
                        borderRadius: '18px',
                        backgroundColor: message.sender === 'user' ? '#63019B' : '#f0f0f0',
                        color: message.sender === 'user' ? 'white' : '#333',
                        wordWrap: 'break-word',
                    }
                }, message.content)
            ]));
        };

        const TestApp = () => {
            const [messages, setMessages] = useState([]);

            const addTestMessage = (type) => {
                let newMessage;
                
                switch(type) {
                    case 'single-tool':
                        newMessage = {
                            id: Date.now(),
                            sender: 'ai',
                            content: 'I found information about Bitmark\'s hackathon for you!',
                            toolUsageIndicators: [
                                {
                                    function_name: 'get_bitmark_general_info',
                                    status: 'completed',
                                    emoji: 'ðŸ“š',
                                    description: 'Looking up Bitmark information'
                                }
                            ],
                            hasToolUsage: true
                        };
                        break;
                    case 'multiple-tools':
                        newMessage = {
                            id: Date.now(),
                            sender: 'ai',
                            content: 'I\'ve analyzed your input and found information about Bitmark!',
                            toolUsageIndicators: [
                                {
                                    function_name: 'get_user_input_info',
                                    status: 'completed',
                                    emoji: 'ðŸ”§',
                                    description: 'Troubleshooting input issues'
                                },
                                {
                                    function_name: 'get_bitmark_general_info',
                                    status: 'completed',
                                    emoji: 'ðŸ“š',
                                    description: 'Looking up Bitmark information'
                                }
                            ],
                            hasToolUsage: true
                        };
                        break;
                    case 'user':
                        newMessage = {
                            id: Date.now(),
                            sender: 'user',
                            content: 'Tell me about Bitmark\'s hackathon'
                        };
                        break;
                    default:
                        return;
                }
                
                setMessages(prev => [...prev, newMessage]);
            };

            return React.createElement('div', { className: 'test-container' }, [
                React.createElement('h1', { key: 'title' }, 'ðŸ› ï¸ Tool Animation Integration Test'),
                
                React.createElement('div', {
                    key: 'controls',
                    style: { marginBottom: '20px' }
                }, [
                    React.createElement(Button, {
                        key: 'single',
                        onClick: () => addTestMessage('single-tool'),
                        style: { margin: '5px' }
                    }, 'Test Single Tool'),
                    React.createElement(Button, {
                        key: 'multiple',
                        onClick: () => addTestMessage('multiple-tools'),
                        style: { margin: '5px' }
                    }, 'Test Multiple Tools'),
                    React.createElement(Button, {
                        key: 'user',
                        onClick: () => addTestMessage('user'),
                        style: { margin: '5px' }
                    }, 'Add User Message'),
                    React.createElement(Button, {
                        key: 'clear',
                        onClick: () => setMessages([]),
                        style: { margin: '5px' }
                    }, 'Clear Messages')
                ]),
                
                React.createElement('div', {
                    key: 'messages',
                    style: {
                        minHeight: '200px',
                        border: '1px solid #ddd',
                        borderRadius: '8px',
                        padding: '10px',
                        backgroundColor: '#fafafa'
                    }
                }, messages.map(msg => 
                    React.createElement(ChatMessage, {
                        key: msg.id,
                        message: msg
                    })
                ))
            ]);
        };

        // Add CSS animations
        const style = document.createElement('style');
        style.textContent = `
            @keyframes toolPulse {
                0%, 100% { transform: scale(1); opacity: 0.8; }
                50% { transform: scale(1.05); opacity: 1; }
            }
            
            @keyframes toolBounce {
                0%, 100% { transform: translateY(0); }
                50% { transform: translateY(-2px); }
            }
            
            @keyframes toolComplete {
                0% { transform: scale(1); }
                50% { transform: scale(1.1); }
                100% { transform: scale(1); }
            }
        `;
        document.head.appendChild(style);

        ReactDOM.render(React.createElement(TestApp), document.getElementById('root'));
    </script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</body>
</html>
